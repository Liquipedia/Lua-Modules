// Participant icon sizes for different view modes:
// - expanded: Desktop expanded view (large team icons in headers)
// - compact: Desktop compact view (smaller team icons in headers)
// - mobile: Mobile/narrow viewports (responsive sizing for small screens)
// - small: Nested/inline icons (team members, potential qualifiers)
$participant-icon-wrapper-size-expanded: 56px;
$participant-icon-wrapper-size-compact: 48px;
$participant-icon-wrapper-size-mobile: 36px;
$participant-icon-wrapper-size-small: 20px;
$participant-icon-size-expanded: 52px;
$participant-icon-size-compact: 44px;
$participant-icon-size-mobile: 33px;
$participant-icon-size-small: 18px;

$compact-selector: '[data-switch-group="team-cards-compact"]';

@mixin set-participant-icon-size($wrapper-size, $icon-size) {
	width: $wrapper-size;
	height: $wrapper-size;
	line-height: $wrapper-size;
	text-align: center;

	img {
		max-width: $icon-size;
		max-height: $icon-size;
		width: auto;
		height: auto;
		vertical-align: middle;
	}
}

.switch-toggle-container:has(#{ $compact-selector }) {
	display: none;

	@media ( min-width: 768px ) {
		display: flex;
	}
}

.team-participant {
	display: flex;
	flex-direction: column;
	gap: 0.5rem;
}

.team-participant__switches {
	display: flex;
	align-items: center;
	gap: 0.5rem;
}

.team-participant__grid {
	display: grid;
	gap: 0.25rem;
	grid-template-columns: repeat( auto-fit, minmax( 280px, 1fr ) );

	@media ( min-width: 1024px ) {
		gap: 0.5rem;
	}
}

.team-participant-card {
	display: flex;
	flex-direction: column;
	gap: 0.25rem;
	justify-content: center;
	align-self: start;
	border-radius: 0.5rem;
	border: 1px solid;
	padding: 0.5rem 0;
	overflow: hidden;

	.theme--light & {
		background-color: var( --clr-secondary-100 );
		border-color: var( --clr-on-surface-light-primary-8 );
	}

	.theme--dark & {
		background-color: var( --clr-on-surface-dark-primary-4 );
		border-color: var( --clr-on-surface-dark-primary-8 );
	}

	&__header {
		display: flex;
		gap: 0.5rem;
		align-items: center;
		align-self: stretch;
		padding: 0 0.5rem;
		cursor: pointer;

		.theme--light & {
			color: var( --clr-secondary-25 );
		}

		.theme--dark & {
			color: var( --clr-secondary-90 );
		}

		.general-collapsible-default-toggle {
			min-width: unset;
		}

		.general-collapsible-expand-button,
		.general-collapsible-collapse-button {
			outline: unset;

			.theme--light & {
				color: var( --clr-secondary-7 );
			}

			.theme--dark & {
				color: var( --clr-secondary-90 );
			}
		}
	}

	&__header-main {
		display: contents;
	}

	&__opponent {
		display: flex;
		gap: 0.5rem;
		align-items: center;
		flex: 1 0 0;
		font-weight: bold;
		min-width: 0;

		.league-icon-small-image > img {
			filter: grayscale( 1 );
			opacity: 0.3;
		}

		&--square-icon {
			.team-template-image-icon,
			.league-icon-small-image {
				@include set-participant-icon-size(
					$participant-icon-wrapper-size-expanded,
					$participant-icon-size-expanded
				);

				@media ( max-width: 767px ) {
					@include set-participant-icon-size(
						$participant-icon-wrapper-size-mobile,
						$participant-icon-size-mobile
					);
				}
			}
		}
	}

	&__label {
		padding: 0.125rem 0.5rem;
		border-radius: 0.25rem;
		border: 1px solid;
		font-weight: bold;
		font-size: 0.6875rem;

		.theme--light & {
			border-color: var( --clr-on-surface-light-primary-8 );
			color: var( --clr-secondary-9 );
		}

		.theme--dark & {
			border-color: var( --clr-on-surface-dark-primary-8 );
			color: var( --clr-secondary-90 );
		}

		&--tbd {
			.theme--light & {
				color: var( --clr-secondary-80 );
			}

			.theme--dark & {
				color: var( --clr-secondary-44 );
			}
		}
	}

	&__qualifier {
		position: relative;
		display: flex;
		justify-content: space-between;
		border-radius: 0.25rem;
		padding: 0.25rem 0.5rem;
		margin: 0.25rem 0.5rem;
		min-height: 2rem;

		.theme--light & {
			background-color: var( --clr-on-surface-light-primary-4 );
			color: var( --clr-secondary-25 );
		}

		.theme--dark & {
			background-color: var( --clr-on-surface-dark-primary-4 );
			color: var( --clr-secondary-90 );
		}

		a & {
			color: inherit;
		}

		a {
			&::after {
				content: "";
				position: absolute;
				inset: 0;
				z-index: 1;
			}
		}

		&--header {
			display: none;
		}

		&--content {
			display: flex;
		}
	}

	&__qualifier-content {
		display: flex;
		gap: 0.25rem;
		align-items: center;
	}

	&__qualifier-details {
		display: flex;
		flex-direction: column;
		font-weight: bold;
		font-size: 12px;
	}

	&__qualifier-icon {
		.theme--light & {
			color: var( --clr-primary-44 );
		}

		.theme--dark & {
			color: var( --clr-primary-80 );
		}
	}

	&__qualifier-placement {
		align-self: center;
		padding: 0.125rem 0.5rem;
		border-radius: 0.25rem;
		font-weight: bold;
		font-size: 0.6875rem;
	}

	@media ( min-width: 768px ) {
		&__header {
			position: relative;
			flex-direction: column;
			width: 100%;

			.general-collapsible-default-toggle {
				position: absolute;
				top: 50%;
				right: 0.5rem;
				transform: translateY( -50% );
			}
		}

		&__header-main {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 0.5rem;
			width: 100%;
		}

		&__opponent {
			flex-direction: column;
			gap: 0.25rem;

			.team-template-text {
				font-size: 1.125rem;
			}
		}

		&__qualifier--header {
			display: flex;
		}

		&__qualifier--content {
			display: none;
		}
	}

	&__member {
		display: flex;
		gap: 0.25rem;
		align-items: center;
		padding: 0.5rem 0.75rem;

		&--odd {
			.theme--light & {
				background-color: var( --clr-on-surface-light-primary-4 );
			}

			.theme--dark & {
				background-color: var( --clr-on-surface-dark-primary-4 );
			}
		}

		&-role-left {
			display: flex;
			justify-content: center;
			align-items: center;
			width: 20px;
			height: 20px;
			margin-right: 0.25rem;

			& > *:not( span ):not( img ) {
				.theme--light & {
					background-color: var( --clr-on-surface-light-primary-4 );
				}

				.theme--dark & {
					background-color: var( --clr-on-surface-dark-primary-4 );
				}
			}
		}

		&-name {
			flex-grow: 1;
		}

		&-trophies {
			display: flex;
			align-items: center;
			gap: 0.25rem;
			color: var( --clr-secondary-44 );

			&-text {
				font-size: 0.6875rem;
				font-weight: bold;
			}
		}

		&-role-right {
			padding: 0.125rem 0.5rem;
			border-radius: 0.25rem;
			font-weight: bold;
			font-size: 0.6875rem;

			.theme--light & {
				background-color: var( --clr-on-surface-light-primary-4 );
				color: var( --clr-secondary-25 );
			}

			.theme--dark & {
				background-color: var( --clr-on-surface-dark-primary-4 );
				color: var( --clr-secondary-90 );
			}
		}

		&-team {
			.team-participant-icon {
				.team-template-image-icon,
				.league-icon-small-image {
					& > a {
						height: 100%;
						display: flex;
						justify-content: center;
						align-items: center;
					}

					@include set-participant-icon-size(
						$participant-icon-wrapper-size-small,
						$participant-icon-size-small
					);
				}
			}
		}
	}

	&__notifications {
		display: flex;
		flex-direction: column;
		gap: 0.25rem;
		margin: 0.5rem 0.5rem 0;
	}

	&__notification {
		display: flex;
		gap: 0.25rem;
		padding: 0.25rem;
		border-radius: 0.25rem;
		font-size: 0.75rem;

		.theme--light & {
			background-color: var( --clr-on-surface-light-primary-4 );
			color: var( --clr-secondary-25 );
		}

		.theme--dark & {
			background-color: var( --clr-on-surface-dark-primary-4 );
			color: var( --clr-secondary-90 );
		}

		&--highlighted {
			.theme--light & {
				background-color: var( --clr-semantic-gold-90 );
				color: var( --clr-semantic-gold-20 );
			}

			.theme--dark & {
				background-color: var( --clr-semantic-gold-30 );
				color: var( --clr-semantic-gold-90 );
			}

			.team-participant-card__notification-icon {
				.theme--light & {
					color: var( --clr-semantic-gold-30 );
				}
			}
		}
	}

	&__potential-qualifiers {
		display: flex;
		flex-direction: column;
		gap: 0.25rem;

		&-title {
			padding: 0 0.5rem;
			font-size: 0.875rem;
			font-weight: bold;

			.theme--light & {
				color: var( --clr-secondary-25 );
			}

			.theme--dark & {
				color: var( --clr-secondary-90 );
			}
		}

		&-list {
			display: flex;
			flex-direction: column;
		}

		&-item {
			padding: 0.5rem 0.75rem;

			&--odd {
				.theme--light & {
					background-color: var( --clr-on-surface-light-primary-4 );
				}

				.theme--dark & {
					background-color: var( --clr-on-surface-dark-primary-4 );
				}
			}

			.team-template-image-icon {
				@include set-participant-icon-size(
					$participant-icon-wrapper-size-small,
					$participant-icon-size-small
				);
			}
		}
	}
}

.team-participant:has( .switch-toggle-active#{ $compact-selector } ) {
	.team-participant-card {
		&__opponent--square-icon {
			.team-template-image-icon,
			.league-icon-small-image {
				@include set-participant-icon-size(
					$participant-icon-wrapper-size-compact,
					$participant-icon-size-compact
				);

				@media ( max-width: 767px ) {
					@include set-participant-icon-size(
						$participant-icon-wrapper-size-mobile,
						$participant-icon-size-mobile
					);
				}
			}
		}

		&__header {
			position: static;
			flex-direction: row;
			width: auto;

			.general-collapsible-default-toggle {
				position: static;
				top: initial;
				right: initial;
				transform: none;
			}
		}

		&__header-main {
			display: contents;
		}

		&__opponent {
			flex-direction: row;
			gap: 0.5rem;

			.team-template-text {
				font-size: initial;
			}
		}

		&__qualifier--header {
			display: none;
		}

		&__qualifier--content {
			display: flex;
		}
	}
}

.team-participant-icon {
	.team-template-image-icon,
	.league-icon-small-image {
		@include set-participant-icon-size(
			$participant-icon-wrapper-size-compact,
			$participant-icon-size-compact
		);
	}
}
